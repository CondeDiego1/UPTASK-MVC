!function(){let e=[],t=[],a=!1;try{const e=document.querySelector("#agregar-tarea"),t=document.querySelector("#nueva-tarea");(e||t)&&(e.addEventListener("click",(function(){0==a&&r()})),t.addEventListener("click",(function(){0==a&&r()})))}catch(e){}function n(a){const n=a.target.value;t=""!==n?e.filter(e=>e.estadotarea===n):[],o(),i()}function o(){const t=document.querySelector(".pendientes-cantidad"),a=document.querySelector(".completas-cantidad"),n=document.querySelector(".todas-cantidad");t&&document.querySelector(".pendientes").removeChild(t),a&&document.querySelector(".completas").removeChild(a),n&&document.querySelector(".todas").removeChild(n);const o=document.createElement("SPAN");o.textContent=e.filter(e=>"0"===e.estadotarea).length,o.classList.add("pendientes-cantidad"),document.querySelector(".pendientes").appendChild(o);const r=document.createElement("SPAN");r.textContent=e.filter(e=>"1"===e.estadotarea).length,r.classList.add("completas-cantidad"),document.querySelector(".completas").appendChild(r);const c=document.createElement("SPAN");c.textContent=e.length,c.classList.add("todas-cantidad"),document.querySelector(".todas").appendChild(c)}function r(t=!1,a={}){const n=document.createElement("DIV");n.classList.add("modal"),n.innerHTML=`\n      <form class="formulario nueva-tarea">\n        <legend>${t?"Editar tarea":"Añadir tarea"}</legend>\n        <div class="campo">\n          <input\n            type="text"\n            name="tarea"\n            placeholder="Nombre de la tarea"\n            id="tarea"\n            value="${a.nombretarea?a.nombretarea:""}"\n          />\n        </div>\n        <div class="opciones">\n          <input\n            type="submit"\n            class="submit-nueva-tarea"\n            value="${t?"Guardar Cambios":"Añadir Tarea"}"\n          />\n          <button type="button" class="cerrar-modal">\n            Cancelar\n          </button>\n        </div>\n      </form>\n    `,setTimeout(()=>{document.querySelector(".formulario").classList.add("animar")},0);document.querySelector(".cerrar-modal");n.addEventListener("click",(function(o){if(o.preventDefault(),o.target.classList.contains("cerrar-modal")||o.target.classList.contains("modal")){document.querySelector(".formulario").classList.add("cerrar"),setTimeout(()=>{n.remove()},500)}if(o.target.classList.contains("submit-nueva-tarea")){const n=document.querySelector("#tarea").value.trim();if(""===n)return void function(e,t,a){document.querySelector(".alerta")&&document.querySelector(".alerta").remove();const n=document.createElement("DIV");n.classList.add("alerta",t),n.textContent=e,a.parentElement.insertBefore(n,a.nextElementSibling),setTimeout(()=>{n.remove()},4e3)}("El Nombre de la tarea es Obligatorio","error",document.querySelector(".formulario legend"));t?(a.nombretarea=n,d(a)):async function(t){const a=new FormData;a.append("nombretarea",t),a.append("proyecto",c());try{const n="http://localhost:4000/api/tarea",o=await fetch(n,{method:"POST",body:a}),r=await o.json();r&&Swal.fire({position:"center",icon:r.icon,title:r.tipo,text:r.mensaje,button:"OK"}).then(()=>{const a={codigotarea:String(r.codigotarea),nombretarea:t,estadotarea:"0",proyecto:r.proyecto};e=[...e,a],i();document.querySelector(".modal").remove()})}catch(e){console.log(e),Swal.fire({icon:"error",title:"Error",text:e}).then(()=>{})}}(n)}})),document.querySelector(".dashboard").appendChild(n)}function c(){const e=new URLSearchParams(window.location.search);return Object.fromEntries(e.entries()).id}function i(){!function(){const e=document.querySelector("#listado-tareas");for(;e.firstChild;)e.removeChild(e.firstChild)}(),function(){const t=e.filter(e=>"0"===e.estadotarea),a=document.querySelector("#pendientes"),n=document.querySelector(".pendientes");0===t.length?(a.disabled=!0,n.setAttribute("style","cursor:no-drop")):(a.disabled=!1,n.setAttribute("style","cursor:pointer"))}(),function(){const t=e.filter(e=>"1"===e.estadotarea),a=document.querySelector("#completadas"),n=document.querySelector(".completas");0===t.length?(a.disabled=!0,n.setAttribute("style","cursor:no-drop")):(a.disabled=!1,n.setAttribute("style","cursor:pointer"))}();const n=t.length?t:e,o=document.querySelector("#listado-tareas");if(0===n.length){const e=document.createElement("LI");return e.textContent="No hay tareas",e.classList.add("no-tareas"),void o.appendChild(e)}const s={0:"Pendiente",1:"Completa"},l={0:!1,1:!0};n.forEach(t=>{const{codigotarea:n,nombretarea:u,estadotarea:m,proyecto:p}=t,f=document.createElement("LI");f.dataset.id=n,f.classList.add("tarea");const h=document.createElement("P");h.textContent=u,h.onclick=function(){0==a&&r(editar=!0,{...t})};const y=document.createElement("DIV");if(y.classList.add("opciones"),0==a){const a=document.createElement("DIV");a.classList.add("switch");const o=document.createElement("INPUT");o.type="checkbox",o.dataset.estadoTarea=n,o.id=n,o.checked=l[m],o.onclick=function(){!function(e){const t="1"===e.estadotarea?"0":"1";e.estadotarea=t,d(e)}({...t})};const r=document.createElement("DIV");r.classList.add("toggle");const s=document.createElement("P"),u=document.createElement("LABEL");u.setAttribute("for",n),a.appendChild(o),r.appendChild(u),r.appendChild(s),a.appendChild(r);const p=document.createElement("BUTTON");p.classList.add("eliminar-tarea"),p.dataset.id=n,p.textContent="Eliminar",p.onclick=function(){!function(t){Swal.fire({title:"¿Está segur@ de esta acción?",text:"¡No podrás revertir esto!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",cancelButtonText:"Cancelar",confirmButtonText:"¡Sí, eliminar!"}).then(a=>{a.isConfirmed&&async function(t){const{codigotarea:a,nombretarea:n,estadotarea:o}=t,r=new FormData;r.append("codigotarea",a),r.append("nombretarea",n),r.append("estadotarea",o),r.append("url",c());try{const a="/api/tarea/eliminar",n=await fetch(a,{method:"POST",body:r});await n.json()&&(Swal.fire("¡Eliminado!","Tu tarea se eliminó correctamente","success"),e=e.filter(e=>e.codigotarea!==t.codigotarea),i())}catch(e){Swal.fire({icon:"error",title:"Error",text:"No pudimos realizar tu solicitud, intenta nuevamente más tarde"}).then(()=>{})}}(t)})}({...t})},y.appendChild(a),y.appendChild(p)}if(1==a){const e=document.createElement("P");e.textContent=s[m],e.classList.add(s[m]),y.appendChild(e)}f.appendChild(h),f.appendChild(y),o.appendChild(f)})}async function d(t){const{codigotarea:a,nombretarea:n,estadotarea:r}=t,d=new FormData;d.append("codigotarea",a),d.append("nombretarea",n),d.append("estadotarea",r),d.append("url",c());try{const t="/api/tarea/actualizar",c=await fetch(t,{method:"POST",body:d}),s=await c.json();s&&Swal.fire({position:"center",icon:s.icon,title:s.tipo,text:s.mensaje,button:"OK"}).then(()=>{e=e.map(e=>(e.codigotarea===a&&(e.estadotarea=r,e.nombretarea=n),e)),i(),o();const t=document.querySelector(".modal");t&&t.remove()})}catch(e){Swal.fire({icon:"error",title:"Error",text:"No pudimos realizar tu solicitud, intenta nuevamente más tarde."}).then(()=>{}),console.log(e)}}document.querySelectorAll('#filtros input[type="radio"]').forEach(e=>{e.addEventListener("input",n)}),async function(){try{const t="/api/tareas?id="+c(),n=await fetch(t),r=await n.json();e=r.tareas,a=r.participante,i(),o()}catch(e){Swal.fire({icon:"error",title:"Error",text:"No pudimos realizar tu solicitud, intenta nuevamente más tarde."}).then(()=>{}),console.log(e)}}()}();